# 前后端连接说明

## 概述

本文档说明如何将前端（ai_video）与后端（video_ai）进行连接，实现完整的视频推荐系统。

## 后端API接口

### 基础信息
- **服务器地址**: http://localhost:8080
- **完整API地址**: http://localhost:8080

### 主要API端点

#### 1. 用户相关API
```
POST /api/users/register          # 用户注册
GET  /api/users/[object Object]id}             # 根据ID获取用户
GET  /api/users/username/{username} # 根据用户名获取用户
PUT  /api/users/[object Object]id}             # 更新用户信息
GET  /api/users/active           # 获取活跃用户
```

#### 2. 视频相关API
```
GET  /api/videos/public          # 获取公开视频列表
GET  /api/videos/featured        # 获取推荐视频列表
GET  /api/videos/{id}            # 根据ID获取视频详情
POST /api/videos                 # 创建视频
PUT  /api/videos/{id}            # 更新视频
DELETE /api/videos/{id}          # 删除视频
GET  /api/videos/search/title    # 按标题搜索视频
GET  /api/videos/search/description # 按描述搜索视频
GET  /api/videos/search/tag      # 按标签搜索视频
GET  /api/videos/popular         # 获取热门视频
GET  /api/videos/latest          # 获取最新视频
GET  /api/videos/category/{category} # 按分类获取视频
POST /api/videos/{id}/view       # 增加观看次数
POST /api/videos/{id}/like       # 增加点赞次数
POST /api/videos/{id}/unlike     # 减少点赞次数
POST /api/videos/{id}/dislike    # 增加点踩次数
POST /api/videos/{id}/share      # 增加分享次数
POST /api/videos/{id}/comment    # 增加评论次数
```

#### 3. 推荐相关API
```
GET  /api/recommendations/personalized/[object Object]userId} # 获取个性化推荐
GET  /api/recommendations/collaborative/{userId} # 获取协同过滤推荐
GET  /api/recommendations/content-based/{userId} # 获取基于内容的推荐
GET  /api/recommendations/popular # 获取热门推荐
GET  /api/recommendations/latest  # 获取最新推荐
GET  /api/recommendations/hybrid/{userId} # 获取混合推荐
GET  /api/recommendations/similar/[object Object]videoId} # 获取相似视频
POST /api/recommendations/behavior # 记录用户行为
```

####4. 系统API
```
GET  /api/health                 # 健康检查
GET  /api                       # API信息
GET  /api/docs                  # API文档
```

## 前端配置更新

### 1. API服务配置
文件: `src/services/api.js`
```javascript
const API_BASE_URL = http://localhost:8080/api;
```

### 2. Vuex Store更新
文件: `src/store/index.js`
- 添加了所有API调用的actions
- 更新了状态管理逻辑
- 添加了错误处理

### 3. 组件更新
- **HomeView.vue**: 使用真实API获取数据
- **VideosView.vue**: 连接视频列表API
- **VideoDetailView.vue**: 连接视频详情API
- **UploadView.vue**: 连接视频上传API
- **LoginView.vue**: 模拟登录（后端无登录API）
- **RegisterView.vue**: 连接用户注册API

## 启动步骤

### 1. 启动后端服务器
```bash
cd video_ai
# 确保MySQL数据库运行
# 启动Spring Boot应用
mvn spring-boot:run
```

### 2. 启动前端开发服务器
```bash
cd ai_video
npm install
npm run serve
```

### 3 测试连接
```bash
# 运行API测试脚本
node test-api.js
```

## 数据流说明

###1. 视频数据流
```
用户浏览 → 前端请求 → 后端API → 数据库 → 返回数据 → 前端展示
```

### 2 用户行为记录
```
用户操作 → 前端记录 → 后端API → 数据库存储 → 推荐算法更新
```

###3. 推荐数据流
```
用户行为 → 后端分析 → 推荐算法 → 生成推荐 → 前端展示
```

## 注意事项

### 1. CORS配置
后端已配置CORS支持前端跨域请求：
```java
@CrossOrigin(origins = *")
```

### 2. 分页参数
所有列表API支持分页：
- `page`: 页码（从0开始）
- `size`: 每页大小

### 3 错误处理
前端已添加完整的错误处理机制：
- API调用失败提示
- 网络错误处理
- 数据验证

### 4. 模拟功能
由于后端缺少某些功能，前端使用模拟数据：
- 用户登录（后端无登录API）
- 评论系统（后端无评论API）
- 收藏功能（后端无收藏API）

## 测试验证

### 1. API连接测试
运行 `test-api.js` 脚本验证所有API端点。

### 2 功能测试
- 注册新用户
- 浏览视频列表
- 查看视频详情
- 上传视频（需要文件上传功能）

### 3. 推荐系统测试
- 记录用户行为
- 查看个性化推荐
- 测试不同推荐算法

## 故障排除

###1. 连接失败
- 检查后端服务器是否运行
- 确认端口880被占用
- 检查防火墙设置

###2 CORS错误
- 确认后端CORS配置正确
- 检查请求头设置

###3. 数据格式错误
- 检查API响应格式
- 确认前端数据解析正确

## 后续优化

### 1. 功能完善
- 添加用户登录API
- 实现评论系统
- 添加收藏功能
- 完善文件上传

### 2. 性能优化
- 添加数据缓存
- 实现懒加载
- 优化API调用

### 3. 安全增强
- 添加JWT认证
- 实现权限控制
- 添加数据验证

## 总结

前后端已成功连接，主要功能包括：
- ✅ 用户注册
- ✅ 视频浏览和搜索
- ✅ 视频详情查看
- ✅ 用户行为记录
- ✅ 推荐系统
- ✅ 视频上传（基础功能）

系统可以正常运行，用户可以进行基本的视频浏览和推荐功能。 